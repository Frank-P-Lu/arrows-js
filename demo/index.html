<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arrows.js - Demo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    h1 {
      color: white;
      text-align: center;
      margin-bottom: 10px;
      font-size: 3rem;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }

    .subtitle {
      color: rgba(255,255,255,0.9);
      text-align: center;
      margin-bottom: 40px;
      font-size: 1.2rem;
    }

    .section {
      background: white;
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .section h2 {
      color: #1f2937;
      margin-bottom: 20px;
      font-size: 1.8rem;
      border-bottom: 3px solid #667eea;
      padding-bottom: 10px;
    }

    .section p {
      color: #6b7280;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .demo-area {
      position: relative;
      min-height: 300px;
      padding: 20px;
      background: #f9fafb;
      border-radius: 12px;
      border: 2px dashed #e5e7eb;
    }

    .box {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 20px 30px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 12px;
      font-weight: 600;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      cursor: default;
      transition: transform 0.2s ease;
      position: absolute;
    }

    .box:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }

    .box-green {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }

    .box-orange {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    }

    .box-red {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    }

    .box-blue {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    }

    .box-purple {
      background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
    }

    .controls {
      margin-top: 20px;
      padding: 20px;
      background: #eff6ff;
      border-radius: 8px;
      border: 1px solid #dbeafe;
    }

    .controls h3 {
      color: #1e40af;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }

    .control-group {
      margin-bottom: 15px;
    }

    .control-group label {
      display: block;
      color: #374151;
      margin-bottom: 5px;
      font-weight: 500;
      font-size: 0.9rem;
    }

    .control-group input[type="range"] {
      width: 100%;
      height: 8px;
      border-radius: 4px;
      background: #dbeafe;
      outline: none;
      -webkit-appearance: none;
    }

    .control-group input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #3b82f6;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .control-group input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #3b82f6;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      border: none;
    }

    button {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.95rem;
    }

    button:hover {
      background: #2563eb;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    .value-display {
      display: inline-block;
      margin-left: 10px;
      color: #1e40af;
      font-weight: 600;
      font-family: 'Courier New', monospace;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    code {
      background: #1f2937;
      color: #10b981;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }

    .stats {
      background: #fef3c7;
      border: 1px solid #fbbf24;
      border-radius: 8px;
      padding: 15px;
      margin-top: 20px;
      color: #92400e;
    }

    .stats strong {
      color: #78350f;
    }

    /* Specific layouts for demos */
    #demo1 .box:nth-child(1) { top: 50px; left: 50px; }
    #demo1 .box:nth-child(2) { top: 50px; right: 50px; }

    #demo2 .box:nth-child(1) { top: 50px; left: 100px; }
    #demo2 .box:nth-child(2) { top: 50px; right: 100px; }
    #demo2 .box:nth-child(3) { bottom: 50px; left: 50%; transform: translateX(-50%); }

    #demo3 .box:nth-child(1) { top: 30px; left: 30px; }
    #demo3 .box:nth-child(2) { top: 30px; right: 30px; }
    #demo3 .box:nth-child(3) { bottom: 30px; left: 30px; }
    #demo3 .box:nth-child(4) { bottom: 30px; right: 30px; }
    #demo3 .box:nth-child(5) { top: 50%; left: 50%; transform: translate(-50%, -50%); }

    .resizable-demo {
      position: relative;
    }

    .resizable-box {
      position: absolute;
      resize: both;
      overflow: auto;
      min-width: 100px;
      min-height: 60px;
      width: 150px;
      height: 80px;
      border: 2px solid #3b82f6;
    }

    #resizable1 { top: 80px; left: 100px; }
    #resizable2 { top: 80px; right: 100px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚¨å Arrows.js</h1>
    <p class="subtitle">Lightweight, elegant arrow connections for your DOM elements</p>

    <!-- Demo 1: Basic Anchors -->
    <div class="section">
      <h2>1. Basic Anchor Points</h2>
      <p>Demonstrating all anchor types: <code>top</code>, <code>right</code>, <code>bottom</code>, <code>left</code>, <code>center</code>, and <code>auto</code></p>

      <div class="demo-area" id="demo1">
        <div class="box" id="box1">Element A</div>
        <div class="box" id="box2">Element B</div>
      </div>

      <!-- Data attribute approach -->
      <div data-arrow
           data-from="#box1"
           data-to="#box2"
           data-from-anchor="right"
           data-to-anchor="left"
           data-color="#3b82f6"
           data-stroke-width="3">
      </div>
    </div>

    <!-- Demo 2: Curved Arrows -->
    <div class="section">
      <h2>2. Curved Paths</h2>
      <p>Bezier curves connecting multiple elements with different curvature values</p>

      <div class="demo-area" id="demo2">
        <div class="box box-green" id="box3">Start</div>
        <div class="box box-orange" id="box4">Middle</div>
        <div class="box box-red" id="box5">End</div>
      </div>

      <div data-arrow data-from="#box3" data-to="#box5"
           data-from-anchor="right" data-to-anchor="top"
           data-color="#10b981" data-curvature="0.3" data-stroke-width="2.5">
      </div>
      <div data-arrow data-from="#box3" data-to="#box4"
           data-from-anchor="bottom" data-to-anchor="top"
           data-color="#f59e0b" data-curvature="0.2" data-stroke-width="2.5">
      </div>
      <div data-arrow data-from="#box4" data-to="#box5"
           data-from-anchor="bottom" data-to-anchor="top"
           data-color="#ef4444" data-curvature="0.25" data-stroke-width="2.5">
      </div>
    </div>

    <!-- Demo 3: Network Diagram -->
    <div class="section">
      <h2>3. Network / Flowchart</h2>
      <p>Complex connections showing a hub-and-spoke pattern</p>

      <div class="demo-area" id="demo3" style="min-height: 400px;">
        <div class="box box-blue" id="node1">Node 1</div>
        <div class="box box-green" id="node2">Node 2</div>
        <div class="box box-orange" id="node3">Node 3</div>
        <div class="box box-red" id="node4">Node 4</div>
        <div class="box box-purple" id="hub">Hub</div>
      </div>

      <div data-arrow data-from="#node1" data-to="#hub" data-from-anchor="auto" data-to-anchor="auto" data-color="#3b82f6" data-curvature="0.15"></div>
      <div data-arrow data-from="#node2" data-to="#hub" data-from-anchor="auto" data-to-anchor="auto" data-color="#10b981" data-curvature="0.15"></div>
      <div data-arrow data-from="#node3" data-to="#hub" data-from-anchor="auto" data-to-anchor="auto" data-color="#f59e0b" data-curvature="0.15"></div>
      <div data-arrow data-from="#node4" data-to="#hub" data-from-anchor="auto" data-to-anchor="auto" data-color="#ef4444" data-curvature="0.15"></div>
    </div>

    <!-- Demo 4: Interactive Controls -->
    <div class="section">
      <h2>4. Interactive Demo</h2>
      <p>Control arrow properties in real-time with ResizeObserver automatically updating positions</p>

      <div class="demo-area resizable-demo" style="min-height: 400px;">
        <div class="box resizable-box" id="resizable1">
          <strong>Drag corner to resize ‚Üí</strong>
        </div>
        <div class="box resizable-box" id="resizable2">
          <strong>‚Üê Also resizable!</strong>
        </div>
      </div>

      <div class="controls">
        <h3>üé® Arrow Controls</h3>

        <div class="control-group">
          <label>
            Curvature: <span class="value-display" id="curvature-value">0.2</span>
          </label>
          <input type="range" id="curvature-slider" min="0" max="1" step="0.05" value="0.2">
        </div>

        <div class="control-group">
          <label>
            Stroke Width: <span class="value-display" id="stroke-value">3</span>px
          </label>
          <input type="range" id="stroke-slider" min="1" max="10" step="0.5" value="3">
        </div>

        <div class="control-group">
          <label>Arrow Color:</label>
          <button onclick="changeColor('#3b82f6')">Blue</button>
          <button onclick="changeColor('#10b981')">Green</button>
          <button onclick="changeColor('#f59e0b')">Orange</button>
          <button onclick="changeColor('#ef4444')">Red</button>
          <button onclick="changeColor('#8b5cf6')">Purple</button>
        </div>

        <div class="control-group">
          <button onclick="toggleAnimation()">Replay Animation</button>
        </div>
      </div>
    </div>

    <!-- Demo 5: Stress Test -->
    <div class="section">
      <h2>5. Performance Test</h2>
      <p>Rendering 50+ arrows to test performance with ResizeObserver on all elements</p>

      <div class="demo-area" id="stress-test" style="min-height: 500px;"></div>

      <div class="controls">
        <button onclick="generateStressTest(25)">Generate 25 Arrows</button>
        <button onclick="generateStressTest(50)">Generate 50 Arrows</button>
        <button onclick="generateStressTest(100)">Generate 100 Arrows</button>
        <button onclick="clearStressTest()">Clear All</button>

        <div class="stats" id="stats" style="margin-top: 15px; display: none;">
          <strong>Performance:</strong> <span id="arrow-count">0</span> arrows rendered in <span id="render-time">0</span>ms
        </div>
      </div>
    </div>

    <!-- Code Example -->
    <div class="section">
      <h2>üìù Usage Example</h2>
      <p>Simple API - works with vanilla JavaScript, React, Vue, or Phoenix LiveView</p>

      <div style="background: #1f2937; color: #d1d5db; padding: 20px; border-radius: 8px; overflow-x: auto;">
        <pre style="margin: 0; font-family: 'Courier New', monospace; font-size: 0.9rem;">
<span style="color: #9ca3af">// Import the library</span>
<span style="color: #c084fc">import</span> { Arrow, autoInit } <span style="color: #c084fc">from</span> <span style="color: #34d399">'./arrows.js'</span>;

<span style="color: #9ca3af">// Option 1: JavaScript API</span>
<span style="color: #c084fc">const</span> arrow = <span style="color: #c084fc">new</span> <span style="color: #60a5fa">Arrow</span>({
  from: <span style="color: #34d399">'#element-a'</span>,
  to: <span style="color: #34d399">'#element-b'</span>,
  fromAnchor: <span style="color: #34d399">'bottom'</span>,
  toAnchor: <span style="color: #34d399">'top'</span>,
  color: <span style="color: #34d399">'#667eea'</span>,
  strokeWidth: <span style="color: #fbbf24">3</span>,
  curvature: <span style="color: #fbbf24">0.2</span>
});

<span style="color: #9ca3af">// Option 2: Auto-init from HTML data attributes</span>
<span style="color: #60a5fa">autoInit</span>();

<span style="color: #9ca3af">// Update arrow manually</span>
arrow.<span style="color: #60a5fa">update</span>();

<span style="color: #9ca3af">// Change properties</span>
arrow.<span style="color: #60a5fa">setColor</span>(<span style="color: #34d399">'#ff0000'</span>);
arrow.<span style="color: #60a5fa">setCurvature</span>(<span style="color: #fbbf24">0.5</span>);

<span style="color: #9ca3af">// Clean up</span>
arrow.<span style="color: #60a5fa">destroy</span>({ animate: <span style="color: #c084fc">true</span> });
        </pre>
      </div>
    </div>
  </div>

  <script type="module">
    import { Arrow, autoInit } from '../src/arrows.js';

    // Auto-initialize all arrows from data attributes
    let arrows = autoInit();

    // Interactive demo arrow
    let interactiveArrow = new Arrow({
      from: '#resizable1',
      to: '#resizable2',
      fromAnchor: 'right',
      toAnchor: 'left',
      color: '#8b5cf6',
      strokeWidth: 3,
      curvature: 0.2,
      animationDuration: 500,
    });

    // Store globally for controls
    window.interactiveArrow = interactiveArrow;

    // Curvature slider
    const curvatureSlider = document.getElementById('curvature-slider');
    const curvatureValue = document.getElementById('curvature-value');

    curvatureSlider.addEventListener('input', (e) => {
      const value = parseFloat(e.target.value);
      curvatureValue.textContent = value.toFixed(2);
      interactiveArrow.setCurvature(value);
    });

    // Stroke width slider
    const strokeSlider = document.getElementById('stroke-slider');
    const strokeValue = document.getElementById('stroke-value');

    strokeSlider.addEventListener('input', (e) => {
      const value = parseFloat(e.target.value);
      strokeValue.textContent = value.toFixed(1);
      interactiveArrow.strokeWidth = value;
      interactiveArrow.pathElement.setAttribute('stroke-width', value);
    });

    // Color change function
    window.changeColor = function(color) {
      interactiveArrow.setColor(color);
    };

    // Replay animation
    window.toggleAnimation = function() {
      interactiveArrow.destroy({ animate: true });

      setTimeout(() => {
        interactiveArrow = new Arrow({
          from: '#resizable1',
          to: '#resizable2',
          fromAnchor: 'right',
          toAnchor: 'left',
          color: interactiveArrow.color,
          strokeWidth: parseFloat(strokeSlider.value),
          curvature: parseFloat(curvatureSlider.value),
          animationDuration: 500,
        });
        window.interactiveArrow = interactiveArrow;
      }, 500);
    };

    // Stress test
    let stressTestArrows = [];

    window.generateStressTest = function(count) {
      clearStressTest();

      const container = document.getElementById('stress-test');
      const startTime = performance.now();

      // Generate random boxes
      const boxes = [];
      for (let i = 0; i < count; i++) {
        const box = document.createElement('div');
        box.className = 'box';
        box.id = `stress-box-${i}`;
        box.textContent = i + 1;
        box.style.position = 'absolute';
        box.style.left = `${Math.random() * (container.offsetWidth - 100)}px`;
        box.style.top = `${Math.random() * (container.offsetHeight - 60)}px`;
        box.style.padding = '15px 20px';
        box.style.fontSize = '0.9rem';

        // Random color
        const colors = ['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899'];
        const color = colors[Math.floor(Math.random() * colors.length)];
        box.style.background = color;

        container.appendChild(box);
        boxes.push(box);
      }

      // Connect boxes (each to next, plus some random connections)
      for (let i = 0; i < boxes.length - 1; i++) {
        const arrow = new Arrow({
          from: boxes[i],
          to: boxes[i + 1],
          fromAnchor: 'auto',
          toAnchor: 'auto',
          color: '#64748b',
          strokeWidth: 1.5,
          curvature: Math.random() * 0.3,
          animationDuration: 200,
        });
        stressTestArrows.push(arrow);
      }

      // Add some random cross-connections
      for (let i = 0; i < Math.min(count, 20); i++) {
        const from = boxes[Math.floor(Math.random() * boxes.length)];
        const to = boxes[Math.floor(Math.random() * boxes.length)];

        if (from !== to) {
          const arrow = new Arrow({
            from,
            to,
            fromAnchor: 'auto',
            toAnchor: 'auto',
            color: '#cbd5e1',
            strokeWidth: 1,
            curvature: Math.random() * 0.2,
            animationDuration: 100,
          });
          stressTestArrows.push(arrow);
        }
      }

      const endTime = performance.now();
      const renderTime = (endTime - startTime).toFixed(2);

      // Show stats
      document.getElementById('stats').style.display = 'block';
      document.getElementById('arrow-count').textContent = stressTestArrows.length;
      document.getElementById('render-time').textContent = renderTime;
    };

    window.clearStressTest = function() {
      // Destroy all arrows
      stressTestArrows.forEach(arrow => arrow.destroy());
      stressTestArrows = [];

      // Clear boxes
      const container = document.getElementById('stress-test');
      container.innerHTML = '';

      // Hide stats
      document.getElementById('stats').style.display = 'none';
    };

    console.log('‚ú® Arrows.js demo loaded!');
    console.log(`üìä ${arrows.length} arrows initialized from data attributes`);
  </script>
</body>
</html>
